<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Case study - resolving Species Plantarum names • taxize</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Case study - resolving Species Plantarum names">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">taxize</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.10.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/taxize.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/case_study.html">Case study - resolving Species Plantarum names</a>
    </li>
    <li>
      <a href="../articles/datasources.html">taxize data sources</a>
    </li>
    <li>
      <a href="../articles/infotable.html">Key functions in taxize</a>
    </li>
    <li>
      <a href="../articles/name_cleaning.html">Strategies for programmatic name cleaning</a>
    </li>
    <li>
      <a href="../articles/taxonomic_ranks.html">taxonomic ranks</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ropensci/taxize/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Case study - resolving Species Plantarum
names</h1>
                        <h4 data-toc-skip class="author">Tim (<span class="citation">@fozy81</span>)</h4>
            
            <h4 data-toc-skip class="date">2020-09-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/taxize/blob/master/vignettes/case_study.Rmd" class="external-link"><code>vignettes/case_study.Rmd</code></a></small>
      <div class="hidden name"><code>case_study.Rmd</code></div>

    </div>

    
    
<p><em>Species Plantarum</em> by Carl Linnaeus originally published in
1753 and was the first work to consistently describe species using
binominal names. It provides a reference point to chart how the usage of
5940 taxa (a subset of 500 used below) described within have changed
over time. So let’s use the taxize package see if we can resolve these
names and see their current status.</p>
<p>Firstly, let’s see how many of the names still exist in modern
species catologues today. We can use the <code>resolve</code> function
to query the Global Name Resolver.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://docs.ropensci.org/taxize/" class="external-link">"taxize"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://yihui.org/knitr/" class="external-link">"knitr"</a></span><span class="op">)</span></span>
<span><span class="co"># load a subset of Species Plantarum names from the taxize package</span></span>
<span><span class="va">names</span> <span class="op">&lt;-</span> <span class="va">species_plantarum_binomials</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span>,<span class="op">]</span></span>
<span><span class="co"># Species Plantarum names are split into Genus and Species qualifier so need to be paste them</span></span>
<span><span class="co"># together to allow the full binominal names to be sent to the global name resolver</span></span>
<span><span class="va">names</span><span class="op">$</span><span class="va">species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">names</span><span class="op">$</span><span class="va">genus</span>, <span class="va">names</span><span class="op">$</span><span class="va">epithet</span><span class="op">)</span></span>
<span><span class="co"># use resolve function to send binominal names to resolver (this may take some time)</span></span>
<span><span class="va">resolved_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/resolve.html">resolve</a></span><span class="op">(</span><span class="va">names</span><span class="op">$</span><span class="va">species</span><span class="op">)</span></span>
<span><span class="co"># select only the dataframe column from the list send back from gnr</span></span>
<span><span class="va">resolved_names</span> <span class="op">&lt;-</span> <span class="va">resolved_names</span><span class="op">$</span><span class="va">gnr</span></span>
<span><span class="co"># count the distinct names resolved per dataset source</span></span>
<span><span class="va">resolved_names_source</span> <span class="op">&lt;-</span> <span class="va">resolved_names</span><span class="op">[</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"submitted_name"</span>, <span class="st">"data_source_title"</span><span class="op">)</span></span>
<span><span class="op">]</span></span>
<span><span class="va">resolved_names_source</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">resolved_names_source</span><span class="op">)</span></span>
<span><span class="va">resolved_names_source</span><span class="op">$</span><span class="va">count</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">summary_resolved</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">resolved_names_source</span><span class="op">$</span><span class="va">count</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>data_source <span class="op">=</span> <span class="va">resolved_names_source</span><span class="op">$</span><span class="va">data_source_title</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span></span>
<span><span class="va">summary_resolved</span> <span class="op">&lt;-</span> <span class="va">summary_resolved</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">summary_resolved</span>, <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">summary_resolved</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">data_source</th>
<th align="right">x</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">40</td>
<td align="left">uBio NameBank</td>
<td align="right">499</td>
</tr>
<tr class="even">
<td align="left">19</td>
<td align="left">GBIF Backbone Taxonomy</td>
<td align="right">491</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">Catalogue of Life</td>
<td align="right">481</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">Arctos</td>
<td align="right">465</td>
</tr>
<tr class="odd">
<td align="left">36</td>
<td align="left">The International Plant Names Index</td>
<td align="right">460</td>
</tr>
<tr class="even">
<td align="left">39</td>
<td align="left">Tropicos - Missouri Botanical Garden</td>
<td align="right">422</td>
</tr>
<tr class="odd">
<td align="left">21</td>
<td align="left">GRIN Taxonomy for Plants</td>
<td align="right">319</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">BioLib.cz</td>
<td align="right">288</td>
</tr>
<tr class="odd">
<td align="left">11</td>
<td align="left">Encyclopedia of Life</td>
<td align="right">259</td>
</tr>
<tr class="even">
<td align="left">33</td>
<td align="left">Open Tree of Life Reference Taxonomy</td>
<td align="right">249</td>
</tr>
<tr class="odd">
<td align="left">35</td>
<td align="left">The Interim Register of Marine and Nonmarine
Genera</td>
<td align="right">245</td>
</tr>
<tr class="even">
<td align="left">27</td>
<td align="left">ITIS</td>
<td align="right">239</td>
</tr>
<tr class="odd">
<td align="left">12</td>
<td align="left">EUNIS</td>
<td align="right">222</td>
</tr>
<tr class="even">
<td align="left">30</td>
<td align="left">NCBI</td>
<td align="right">218</td>
</tr>
<tr class="odd">
<td align="left">31</td>
<td align="left">nlbif</td>
<td align="right">184</td>
</tr>
<tr class="even">
<td align="left">42</td>
<td align="left">USDA NRCS PLANTS Database</td>
<td align="right">176</td>
</tr>
<tr class="odd">
<td align="left">23</td>
<td align="left">iNaturalist</td>
<td align="right">141</td>
</tr>
<tr class="even">
<td align="left">16</td>
<td align="left">Freebase</td>
<td align="right">135</td>
</tr>
<tr class="odd">
<td align="left">41</td>
<td align="left">Union 4</td>
<td align="right">133</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="left">Database of Vascular Plants of Canada (VASCAN)</td>
<td align="right">123</td>
</tr>
</tbody>
</table>
<p>The table above shows none of the data sources provided can resolve
all of the names in the <em>Species Plantarum</em>. Let’s see if between
all the data sources we can resolve all the names.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gnr_names</span> <span class="op">&lt;-</span> <span class="va">resolved_names</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"submitted_name"</span>, <span class="st">"score"</span><span class="op">)</span><span class="op">]</span> </span>
<span><span class="va">gnr_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">gnr_names</span><span class="op">)</span></span>
<span></span>
<span><span class="va">merge_gnr_plantarum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">names</span>, <span class="va">gnr_names</span>,</span>
<span>  by.x <span class="op">=</span> <span class="st">"species"</span>, by.y <span class="op">=</span> <span class="st">"submitted_name"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">merge_gnr_plantarum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">merge_gnr_plantarum</span><span class="op">$</span><span class="va">score</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>data_source <span class="op">=</span> <span class="va">merge_gnr_plantarum</span><span class="op">$</span><span class="va">species</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">merge_gnr_plantarum</span><span class="op">$</span><span class="va">data_source</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 500</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">merge_gnr_plantarum</span><span class="op">$</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.75</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">merge_gnr_plantarum</span><span class="op">$</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.9915</span></span></code></pre></div>
<p>Even though no individual name data source can resolve all the names,
taken together all names in <em>Species Plantarum</em> can be resolved
using modern sources. Noting that some names score poorly in terms of
fuzzy matching. The poor matching could indicate imperfect matches and
perhaps some matches are due to species identified after 1752 sharing
similar names. There are lots of questions regarding the history of many
of these original binominals and their journey into present day
taxonomy.</p>
<p>For example, let’s see how many of these names are still the
‘accepted’ names according to ITIS. Not all the data providers give an
accepted name. So lets use ITIS as the <code>get_tsn_</code> function
returns a <code>nameUsage</code> variable which indicates if a name is
still accepted or not.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># find resolved species Plantarum names returned from ITIS</span></span>
<span><span class="va">itis_resolved</span> <span class="op">&lt;-</span> <span class="va">resolved_names</span><span class="op">$</span><span class="va">submitted_name</span><span class="op">[</span><span class="va">resolved_names</span><span class="op">$</span><span class="va">data_source_title</span> <span class="op">==</span> <span class="st">"ITIS"</span><span class="op">]</span></span>
<span><span class="co"># select random sub-selection to save time</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span> </span>
<span><span class="va">itis_sample</span> <span class="op">&lt;-</span> <span class="va">itis_resolved</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">itis_resolved</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="fl">200</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co"># query ITIS (this may take some time)</span></span>
<span><span class="va">its_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_tsn.html">get_tsn_</a></span><span class="op">(</span><span class="va">itis_sample</span><span class="op">)</span></span>
<span><span class="va">its_names_bind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="va">its_names</span><span class="op">)</span></span>
<span><span class="va">its_names_bind</span><span class="op">$</span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="co"># count the number of names in each nameUsage category </span></span>
<span><span class="va">its_names_agg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">its_names_bind</span><span class="op">$</span><span class="va">n</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>data_source <span class="op">=</span> <span class="va">its_names_bind</span><span class="op">$</span><span class="va">nameUsage</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">its_names_agg</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">data_source</th>
<th align="right">x</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">accepted</td>
<td align="right">195</td>
</tr>
<tr class="even">
<td align="left">valid</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>Of all the <em>Species Plantarum</em> names found in the ITIS data
source, a high number (of 200 randomly selected names) are still the
‘accepted’ name. This indicates Carl Linnaeus, as widely acknowledged,
identified well-thought-out and pragmatic taxonomic concepts which have
proved useful until the present day.</p>
<p>Further research may discover why some names appear not to be used
today in some data sources and where they are used, why some are no
longer the accepted name.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Scott Chamberlain, Eduard Szoecs, Zachary Foster, Zebulun Arendsee, rOpenSci.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
