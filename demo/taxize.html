<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Install taxize (uncomment to run)</title>

<base target="_blank"/>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
}

pre code {
   display: block; padding: 0.5em;
}

code.r {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<h1>Install taxize (uncomment to run)</h1>

<pre><code class="r"># install_github(&#39;taxize_&#39;, &#39;ropensci&#39;)
library(taxize)
library(plyr)
library(ape)
library(XML)
require(RCurl)
</code></pre>

<pre><code>## Loading required package: RCurl
</code></pre>

<pre><code>## Loading required package: bitops
</code></pre>

<hr/>

<h1>Phylomatic</h1>

<h2>Fetch a phylogenetic tree from Phylomatic</h2>

<pre><code class="r">mytree &lt;- &quot;asteraceae/bidens/bidens_cernua\nasteraceae/madia/madia_exigua\nasteraceae/helianthus/helianthus_annuus&quot;
</code></pre>

<h2>Using tree strings that need to be formatted within the function</h2>

<h3>Return a tree in the phylo object format</h3>

<pre><code class="r">get_phylomatic_tree(mytree, &quot;TRUE&quot;, &quot;GET&quot;, &quot;xml&quot;, &quot;TRUE&quot;)
</code></pre>

<pre><code>## 
## Phylogenetic tree with 3 tips and 2 internal nodes.
## 
## Tip labels:
## [1] &quot;bidens_cernua&quot;     &quot;madia_exigua&quot;      &quot;helianthus_annuus&quot;
##  Node labels:
## [1] &quot;euphyllophyte&quot; &quot;&quot;             
## 
## Rooted; includes branch lengths.
</code></pre>

<h3>Return a tree in the phylo object format, using POST method</h3>

<pre><code class="r">get_phylomatic_tree(mytree, &quot;TRUE&quot;, &quot;POST&quot;, &quot;xml&quot;, &quot;TRUE&quot;)
</code></pre>

<pre><code>## 
## Phylogenetic tree with 3 tips and 2 internal nodes.
## 
## Tip labels:
## [1] &quot;bidens_cernua&quot;     &quot;madia_exigua&quot;      &quot;helianthus_annuus&quot;
##  Node labels:
## [1] &quot;euphyllophyte&quot; &quot;&quot;             
## 
## Rooted; includes branch lengths.
</code></pre>

<h3>Return tree in newick format</h3>

<pre><code class="r">get_phylomatic_tree(mytree, &quot;TRUE&quot;, &quot;GET&quot;, &quot;new&quot;, &quot;FALSE&quot;)
</code></pre>

<pre><code>## [1] &quot;(bidens_cernua:3.000000,(madia_exigua:10.000000,helianthus_annuus:5.000000):3.000000)euphyllophyte:42;&quot;
</code></pre>

<h3>Get a tree in newick format, read using ape::read.tree, and plot</h3>

<pre><code class="r">tree &lt;- get_phylomatic_tree(mytree, &quot;TRUE&quot;, &quot;POST&quot;, &quot;new&quot;, &quot;FALSE&quot;)
treephylo &lt;- read.tree(text = tree)
plot(treephylo)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk phylog1"/> </p>

<hr/>

<h1>Integrated Taxonomic Informaiton Service (ITIS)</h1>

<h2>Search by term and search type</h2>

<p>Note: TSN stands for Taxonomic Serial Number</p>

<pre><code class="r">doc &lt;- get_itis_xml(&quot;dolphin&quot;, &quot;comname&quot;, &quot;name&quot;)
doc &lt;- get_itis_xml(&quot;grizzly bear&quot;, &quot;comnameend&quot;, &quot;name&quot;)
doc &lt;- get_itis_xml(&quot;ursidae&quot;, &quot;itistermssciname&quot;, &quot;name&quot;)
</code></pre>

<h2>Take advantage of default arguments, spaces accepted, and display data.frame output</h2>

<pre><code class="r">doc &lt;- get_itis_xml(&quot;Plethodon &quot;)
head(parse_itis(doc))
</code></pre>

<pre><code>##                        sci    com    tsn
## 1         Plethodon aeneus 208328 208328
## 2     Plethodon ainsworthi 668315 668315
## 3       Plethodon albagula 208278 208278
## 4         Plethodon amplus 668316 668316
## 5 Plethodon angusticlavius 668317 668317
## 6         Plethodon asupak 685566 685566
</code></pre>

<h2>Show higher taxonomy for a given TSN</h2>

<pre><code class="r">classification(685566, ID = &quot;tsn&quot;)
</code></pre>

<pre><code>## [[1]]
##        rank            taxon    tsn
## 1   Kingdom         Animalia 685566
## 2    Phylum         Chordata 202423
## 3 Subphylum       Vertebrata 158852
## 4     Class         Amphibia 331030
## 5     Order          Caudata 173420
## 6    Family   Plethodontidae 173584
## 7 Subfamily   Plethodontinae 173631
## 8     Genus        Plethodon 550197
## 9   Species Plethodon asupak 173648
</code></pre>

<h2>Get a TSN from a species name</h2>

<pre><code class="r">tsn &lt;- get_tsn(searchterm = &quot;Quercus_douglasii&quot;, searchtype = &quot;sciname&quot;)
# use classification with get_tsn together:
classification(tsn)
</code></pre>

<pre><code>## $`1`
##             rank             taxon    tsn
## 1        Kingdom           Plantae  19322
## 2     Subkingdom    Viridaeplantae 202422
## 3   Infrakingdom      Streptophyta 846492
## 4       Division      Tracheophyta 846494
## 5    Subdivision   Spermatophytina 846496
## 6  Infradivision      Angiospermae 846504
## 7          Class     Magnoliopsida 846505
## 8     Superorder           Rosanae  18063
## 9          Order           Fagales 846548
## 10        Family          Fagaceae  19273
## 11         Genus           Quercus  19275
## 12       Species Quercus douglasii  19276
</code></pre>

<hr/>

<h1>NCBI Taxonomy Browser</h1>

<h2>Get Unique Identifier</h2>

<pre><code class="r">uids &lt;- get_uid(c(&quot;Chironomus riparius&quot;, &quot;Chaetopteryx&quot;))
</code></pre>

<h2>And retrieve classification</h2>

<pre><code class="r">cl &lt;- classification(uids)
cl
</code></pre>

<pre><code>## [[1]]
##               ScientificName         Rank     UID
## 1         cellular organisms      no rank  131567
## 2                  Eukaryota superkingdom    2759
## 3               Opisthokonta      no rank   33154
## 4                    Metazoa      kingdom   33208
## 5                  Eumetazoa      no rank    6072
## 6                  Bilateria      no rank   33213
## 7                  Coelomata      no rank   33316
## 8                Protostomia      no rank   33317
## 9                  Ecdysozoa      no rank 1206794
## 10             Panarthropoda      no rank   88770
## 11                Arthropoda       phylum    6656
## 12               Mandibulata      no rank  197563
## 13              Pancrustacea      no rank  197562
## 14                  Hexapoda   superclass    6960
## 15                   Insecta        class   50557
## 16                Dicondylia      no rank   85512
## 17                 Pterygota      no rank    7496
## 18                  Neoptera     subclass   33340
## 19             Endopterygota   infraclass   33392
## 20                   Diptera        order    7147
## 21                Nematocera     suborder    7148
## 22              Culicimorpha   infraorder   43786
## 23             Chironomoidea  superfamily   41828
## 24              Chironomidae       family    7149
## 25              Chironominae    subfamily   54970
## 26               Chironomini        tribe   72530
## 27                Chironomus        genus    7150
## 28 Chironomus incertae sedis      no rank 1165752
## 
## [[2]]
##        ScientificName         Rank     UID
## 1  cellular organisms      no rank  131567
## 2           Eukaryota superkingdom    2759
## 3        Opisthokonta      no rank   33154
## 4             Metazoa      kingdom   33208
## 5           Eumetazoa      no rank    6072
## 6           Bilateria      no rank   33213
## 7           Coelomata      no rank   33316
## 8         Protostomia      no rank   33317
## 9           Ecdysozoa      no rank 1206794
## 10      Panarthropoda      no rank   88770
## 11         Arthropoda       phylum    6656
## 12        Mandibulata      no rank  197563
## 13       Pancrustacea      no rank  197562
## 14           Hexapoda   superclass    6960
## 15            Insecta        class   50557
## 16         Dicondylia      no rank   85512
## 17          Pterygota      no rank    7496
## 18           Neoptera     subclass   33340
## 19      Endopterygota   infraclass   33392
## 20   Amphiesmenoptera   superorder   85604
## 21        Trichoptera        order   30263
## 22      Integripalpia     suborder   93875
## 23     Limnephiloidea  superfamily   41033
## 24      Limnephilidae       family   50645
## 25      Limnephilinae    subfamily  177669
## 26    Chaetopterygini        tribe  492564
</code></pre>

<hr/>

<h1>Using ITIS and Phylomatic together</h1>

<h2>Use ITIS and get_phymat_format to format a string for each species to be submitted to Phylomatic</h2>

<pre><code class="r">dat_ &lt;- laply(list(&quot;36616&quot;, &quot;19322&quot;, &quot;183327&quot;), get_phymat_format, format = &quot;rsubmit&quot;)
dat_
</code></pre>

<pre><code>## [1] &quot;asteraceae%2Fhelianthus%2Fhelianthus_annuus&quot;
## [2] &quot;fagaceae%2Fquercus%2Fquercus_douglasii&quot;     
## [3] &quot;pinaceae%2Fpinus%2Fpinus_contorta&quot;
</code></pre>

<pre><code class="r">dat_mine &lt;- paste(dat_, collapse = &quot;%0D%0A&quot;)  # collapse and replace \n&#39;s
dat_mine
</code></pre>

<pre><code>## [1] &quot;asteraceae%2Fhelianthus%2Fhelianthus_annuus%0D%0Afagaceae%2Fquercus%2Fquercus_douglasii%0D%0Apinaceae%2Fpinus%2Fpinus_contorta&quot;
</code></pre>

<pre><code class="r">tree &lt;- get_phylomatic_tree(dat_mine, &quot;FALSE&quot;, &quot;GET&quot;, &quot;new&quot;, &quot;TRUE&quot;)
tree
</code></pre>

<pre><code>## 
## Phylogenetic tree with 3 tips and 2 internal nodes.
## 
## Tip labels:
## [1] &quot;helianthus_annuus&quot; &quot;quercus_douglasii&quot; &quot;pinus_contorta&quot;   
##  Node labels:
## [1] &quot;euphyllophyte&quot; &quot;&quot;             
## 
## Rooted; includes branch lengths.
</code></pre>

<pre><code class="r">plot(tree)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk phylog2"/> </p>

<h2>A somewhat realistic workflow</h2>

<h3>User&#39;s species list</h3>

<pre><code class="r">splist &lt;- c(&quot;annona cherimola&quot;, &quot;annona muricata&quot;, &quot;quercus robur&quot;, &quot;shorea robusta&quot;, 
    &quot;pandanus patina&quot;, &quot;oryza sativa&quot;, &quot;durio zibethinus&quot;)
</code></pre>

<h3>Get TSN code for each species</h3>

<pre><code class="r">tsns &lt;- get_tsn(splist, &quot;sciname&quot;)
</code></pre>

<pre><code>## Error: Results must have the same dimensions.
</code></pre>

<pre><code class="r">tsns
</code></pre>

<pre><code>## Error: object &#39;tsns&#39; not found
</code></pre>

<h3>Get Phylomatic formatted strings for each species</h3>

<pre><code class="r">dat_ &lt;- laply(tsns, get_phymat_format, format = &quot;rsubmit&quot;)
</code></pre>

<pre><code>## Error: object &#39;tsns&#39; not found
</code></pre>

<pre><code class="r">dat_
</code></pre>

<pre><code>## [1] &quot;asteraceae%2Fhelianthus%2Fhelianthus_annuus&quot;
## [2] &quot;fagaceae%2Fquercus%2Fquercus_douglasii&quot;     
## [3] &quot;pinaceae%2Fpinus%2Fpinus_contorta&quot;
</code></pre>

<h3>Send strings to Phylomatic and return newick tree</h3>

<pre><code class="r">tree &lt;- get_phylomatic_tree(dat_, &quot;TRUE&quot;, &quot;GET&quot;, &quot;new&quot;, &quot;TRUE&quot;)
tree
</code></pre>

<pre><code>## 
## Phylogenetic tree with 3 tips and 2 internal nodes.
## 
## Tip labels:
## [1] &quot;helianthus_annuus&quot; &quot;quercus_douglasii&quot; &quot;pinus_contorta&quot;   
##  Node labels:
## [1] &quot;euphyllophyte&quot; &quot;&quot;             
## 
## Rooted; includes branch lengths.
</code></pre>

<h3>Plot tree, etc.</h3>

<pre><code class="r">plot(tree)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk phylog3"/> </p>

<hr/>

<h1>Taxonomic Name Resolution Service</h1>

<h2>Name matching using the TNRS</h2>

<pre><code class="r">tnrsmatch(&quot;best&quot;, taxnames = c(&quot;helianthus annuus&quot;, &quot;acacia&quot;, &quot;saltea&quot;), output = &quot;names&quot;)  # just best names
</code></pre>

<pre><code>## Hitting the TNRS API and matching names...
</code></pre>

<pre><code>##        AcceptedName   MatchFam MatchGenus MatchScore    Accept?
## 1 Helianthus annuus Asteraceae Helianthus          1 No opinion
## 2            Acacia   Fabaceae     Acacia          1 No opinion
## 3                                 Saltera       0.93 No opinion
##      SubmittedNames
## 1 helianthus annuus
## 2            acacia
## 3            saltea
</code></pre>

<hr/>

<h1>Global Names Resolver (GNR)</h1>

<h2>Get just id&#39;s and names of sources in a data.frame</h2>

<pre><code class="r">tail(gnr_datasources(todf = T))
</code></pre>

<pre><code>##     id                                title
## 82 164                            BioLib.cz
## 83 165 Tropicos - Missouri Botanical Garden
## 84 166                                nlbif
## 85 167  The International Plant Names Index
## 86 168              Index to Organism Names
## 87 169                        uBio NameBank
</code></pre>

<hr/>

<h2>Give me the id for EOL (Encyclopedia of Life)</h2>

<pre><code class="r">out &lt;- gnr_datasources(todf = T)
out[out$title == &quot;EOL&quot;, &quot;id&quot;]
</code></pre>

<pre><code>## [1] 12
</code></pre>

<hr/>

<h2>Fuzzy search for sources with the word &ldquo;zoo&rdquo;</h2>

<pre><code class="r">out &lt;- gnr_datasources(todf = T)
outdf &lt;- out[agrep(&quot;zoo&quot;, out$title, ignore.case = T), ]
outdf[1:2, ]
</code></pre>

<pre><code>##     id             title
## 20 100 Mushroom Observer
## 25 105           ZooKeys
</code></pre>

<hr/>

<h2>Resolve some names</h2>

<h3>Search for <em>Helianthus annuus</em> and <em>Homo sapiens</em>, return a data.frame</h3>

<pre><code class="r">gnr(names = c(&quot;Helianthus annuus&quot;, &quot;Homo sapiens&quot;), returndf = TRUE)[1:2, ]
</code></pre>

<pre><code>##   data_source_id    submitted_name       name_string score    title
## 1              4 Helianthus annuus Helianthus annuus 0.988     NCBI
## 3             10 Helianthus annuus Helianthus annuus 0.988 Freebase
</code></pre>

<hr/>

<h3>Search for the same species, with only using data source 12 (i.e., EOL)</h3>

<pre><code class="r">gnr(names = c(&quot;Helianthus annuus&quot;, &quot;Homo sapiens&quot;), data_source_ids = &quot;12&quot;, 
    returndf = TRUE)
</code></pre>

<pre><code>##   data_source_id    submitted_name       name_string score title
## 1             12 Helianthus annuus Helianthus annuus 0.988   EOL
## 2             12      Homo sapiens      Homo sapiens 0.988   EOL
</code></pre>

<hr/>

<h1>Tropicos: all Tropicos functions start with &ldquo;tp_&rdquo;</h1>

<pre><code class="r">head(tp_getacceptednames(id = 25503923))
</code></pre>

<pre><code>## http://services.tropicos.org/Name/25503923/AcceptedNames?apikey=e63f602b-f212-4c53-964c-94e70fb2707e&amp;format=json
</code></pre>

<pre><code>##                    variable             value category
## 1                    NameId          25503923  Synonym
## 2            ScientificName       Aira pumila  Synonym
## 3 ScientificNameWithAuthors Aira pumila Pursh  Synonym
## 4                    Family           Poaceae  Synonym
## 5                    NameId          25509881 Accepted
## 6            ScientificName         Poa annua Accepted
</code></pre>

<pre><code class="r">head(tp_getsynonyms(id = 25509881))
</code></pre>

<pre><code>## http://services.tropicos.org/Name/25509881/Synonyms?apikey=e63f602b-f212-4c53-964c-94e70fb2707e&amp;format=json
</code></pre>

<pre><code>##                    variable             value category
## 1                    NameId          25503923  Synonym
## 2            ScientificName       Aira pumila  Synonym
## 3 ScientificNameWithAuthors Aira pumila Pursh  Synonym
## 4                    Family           Poaceae  Synonym
## 5                    NameId          25509881 Accepted
## 6            ScientificName         Poa annua Accepted
</code></pre>

<hr/>

<h1>uBio</h1>

<h2>Search uBio using the namebank_search API method.</h2>

<pre><code class="r">ubio_namebank_search(searchName = &quot;elephant&quot;, sci = 1, vern = 0)
</code></pre>

<pre><code>##   namebankID               nameString           fullNameString packageID
## 1    6938660 Q2VyeWxvbiBlbGVwaGFudA== Q2VyeWxvbiBlbGVwaGFudA==        80
##   packageName basionymUnit rankID rankName
## 1 Cerylonidae      6938660     24  species
</code></pre>

<pre><code class="r">head(ubio_namebank_search(searchName = &quot;Helianthus annuus&quot;, sci = 1, vern = 0)[, 
    -c(2, 3)])
</code></pre>

<pre><code>##   namebankID packageID packageName basionymUnit rankID   rankName
## 1    2658020       598   Asterales            0     24    species
## 2     462478       598   Asterales            0     24    species
## 3    9073865      5634  Asteraceae            0    444         fo
## 4    9073864      5634  Asteraceae            0    444         fo
## 5    8624412      5634  Asteraceae      8722942    444         fo
## 6    8291505      5634  Asteraceae            0    265 subspecies
</code></pre>

<pre><code class="r">out &lt;- lapply(list(&quot;Helianthus debilis&quot;, &quot;Astragalus aduncus&quot;), function(x) ubio_namebank_search(searchName = x, 
    sci = 1, vern = 0))
head(out[[2]][, -c(2, 3)])  # just Astragalus aduncus output
</code></pre>

<pre><code>##   namebankID packageID packageName basionymUnit rankID rankName
## 1    2843601       663     Rosales            0     24  species
## 2    9261962      5780    Fabaceae            0    261       SP
## 3    9261999      5780    Fabaceae            0    261       SP
## 4    9261975      5780    Fabaceae            0    261       SP
## 5     704148       663     Rosales            0     24  species
## 6    8374424      5780    Fabaceae       722833    444       fo
</code></pre>

<hr/>

<h1>IUCN Red List</h1>

<h2>Query the Red List API</h2>

<pre><code class="r">ia &lt;- iucn_summary(c(&quot;Panthera uncia&quot;, &quot;Lynx lynx&quot;))
</code></pre>

<h3>Extract Status</h3>

<pre><code class="r">laply(ia, function(x) x$status)
</code></pre>

<pre><code>## [1] &quot;EN&quot; &quot;LC&quot;
</code></pre>

</body>

</html>

